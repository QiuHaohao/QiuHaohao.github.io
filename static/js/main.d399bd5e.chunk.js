(window["webpackJsonpfacial-attendance"]=window["webpackJsonpfacial-attendance"]||[]).push([[0],{160:function(e,t,n){e.exports=n.p+"static/media/logo.bc04722f.png"},168:function(e,t,n){e.exports=n(345)},173:function(e,t,n){},175:function(e,t,n){},192:function(e){e.exports=JSON.parse('{"urlBase":"http://172.21.148.166:8000","pathSession":"/api/session/","pathImage":"/session/image/","pathLab":"/api/labs/","pathStudents":"/api/students/","pathAuthToken":"/auth/token/","pathAuthVerify":"/auth/verify/"}')},234:function(e,t,n){},235:function(e,t,n){},251:function(e,t,n){},252:function(e,t,n){},253:function(e,t,n){},254:function(e,t,n){},264:function(e,t,n){},265:function(e,t,n){},266:function(e,t,n){},343:function(e,t,n){},344:function(e,t,n){},345:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),o=n(4),c=n.n(o),s=(n(173),n(37)),i=(n(174),n(175),n(21)),u=n(41),l=n.n(u),m=n(352),f=n(192);var d={postBase64Image:function(e,t){return l.a.post(f.urlBase+f.pathImage,{sid:e,image:t}).then((function(e){return e.data.map((function(e){return{mid:e.student,status:e.status}}))}))},getToken:function(e,t){return l.a.post("".concat(f.urlBase+f.pathAuthToken),{username:e,password:t})},getStudentsByLid:function(e){return l.a.get("".concat(f.urlBase+f.pathStudents,"?lab=").concat(e)).then((function(e){return e.data.map((function(e){return{mid:e.matric_num,name:e.name,email:e.email}}))}))},verifyToken:function(e){return l.a.post("".concat(f.urlBase+f.pathAuthVerify),{token:e})},startSession:function(e){return l.a.post(f.urlBase+f.pathSession,{lab:e})}},p=Object(a.createContext)(),g=function(){return Object(a.useContext)(p)};function v(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(null),c=Object(i.a)(o,2),s=c[0],u=c[1],f=Object(a.useState)(null),p=Object(i.a)(f,2),g=p[0],v=p[1],h=Object(a.useState)(null),b=Object(i.a)(h,2),E=b[0],O=b[1],j=function(e){u(e.data.user.username),v(e.data.user.id),O(e.data.user.labs),l.a.defaults.headers.common.Authorization="JWT ".concat(e.data.token),sessionStorage.setItem("jwtToken",e.data.token),r(!0)};return Object(a.useEffect)((function(){if(!n){var e=sessionStorage.getItem("jwtToken");null!==e&&function(e){var t=e.token;d.verifyToken(t).then(j,(function(){}))}({token:e})}})),{userName:s,tid:g,labs:E,isSignedIn:n,signIn:function(e){var t=e.username,n=e.password;return d.getToken(t,n).then(j,(function(){m.a.warning("Wrong Credential, try again!")}))},signOut:function(){r(!1),u(null),v(null),O(null),delete l.a.defaults.headers.common.Authorization,sessionStorage.removeItem("jwtToken")}}}function h(e){var t=e.children,n=v();return r.a.createElement(p.Provider,{value:n},t)}function b(e){return"".concat(e.course," - ").concat(e.group)}var E=n(154),O=n(71),j=n(51),y=n.n(j);function S(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function w(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?S(n,!0).forEach((function(t){Object(E.a)(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):S(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var N=Object(a.createContext)(),k=function(){return Object(a.useContext)(N)};function I(){var e=Object(a.useState)(!1),t=Object(i.a)(e,2),n=t[0],r=t[1],o=Object(a.useState)(null),c=Object(i.a)(o,2),s=c[0],u=c[1],l=Object(a.useState)(null),f=Object(i.a)(l,2),p=f[0],g=f[1],v=Object(a.useState)(null),h=Object(i.a)(v,2),b=h[0],E=h[1],j=Object(a.useState)(null),S=Object(i.a)(j,2),N=S[0],k=S[1],I=function(e){var t=N;e.forEach((function(e){t=function(e,t){var n=e.mid,a=e.status,r=y.a.findIndex(t,{mid:n});return[].concat(Object(O.a)(t.slice(0,r)),[w({},N[r],{status:a})],Object(O.a)(t.slice(r+1)))}(e,t)})),y.a.isEqual(t,N)||k(t)};return Object(a.useEffect)((function(){})),{isOnGoing:n,sid:s,lab:p,startTime:b,students:N,startSession:function(e){return d.startSession(e.lid).then((function(t){d.getStudentsByLid(e.lid).then((function(n){!function(e,t,n){u(t.data.sid),g(e),E(Date.now()),k(n),r(!0)}(e,t,n)}))}),(function(){m.a.error("Session Failed to Start!")}))},endSession:function(){r(!1),u(null),g(null),E(null),k(null)},postImage:function(e){return d.postBase64Image(s,e).then(I)}}}function x(e){var t=e.children,n=I();return r.a.createElement(N.Provider,{value:n},t)}var A=n(346),C=n(46),T=(n(234),n(235),n(351)),B=T.a.confirm;var P=function(){var e=k(),t=g(),n=r.a.createElement("div",{className:"sign-out",onClick:function(){B({title:"Do you Want to sign out?",okText:"Yes",cancelText:"No",onOk:t.signOut})}},"Sign Out.");return r.a.createElement("div",{className:"user-status user-status-signed-in"},"Hi, ".concat(t.userName,"! "),e.isOnGoing?null:n)};var L=Object(C.g)((function(){return r.a.createElement("div",{className:"user-status user-status-not-signed-in"},"You are not signed in.")}));var D=function(){return g().isSignedIn?r.a.createElement(P,null):r.a.createElement(L,null)},G=n(348);var M=Object(C.g)((function(e){var t=e.location,n=e.items,a=y.a.filter(Object(O.a)(n.keys()),(function(e){return t.pathname.length>=n[e].path.length&&n[e].path===t.pathname.substr(0,n[e].path.length)})).map(String);return r.a.createElement(G.a,{theme:"dark",mode:"horizontal",style:{lineHeight:"64px"},selectedKeys:a},n.map((function(e,t){return r.a.createElement(G.a.Item,{key:String(t)},r.a.createElement(s.b,{to:e.path},e.displayName))})))}));var W=Object(C.g)((function(){var e=g();return r.a.createElement("div",{className:"header"},r.a.createElement(D,null),r.a.createElement(M,{items:e.isSignedIn?[{displayName:"Session",path:"/session"},{displayName:"Lab Groups",path:"/labs"}]:[{displayName:"Sign in",path:"/signin"}]}))})),F=n(165);var J=function(e){var t=e.component,n=e.when,a=e.to,o=Object(F.a)(e,["component","when","to"]);return r.a.createElement(C.b,Object.assign({},o,{render:function(e){return!0===n?r.a.createElement(C.a,{to:a}):r.a.createElement(t,e)}}))},q=n(40),z=n(70),H=z.a.Option;var R=function(e){return r.a.createElement(z.a,{className:e.className,onChange:function(t){return e.onChange(t)}},e.options.map((function(e,t){return r.a.createElement(H,{key:t,value:e.value},e.name)})))};n(251);var Y=function(e){var t=k(),n=Object(a.useState)(null),o=Object(i.a)(n,2),c=o[0],s=o[1],u=e.labs.map((function(e){return{value:e.lid,name:b(e)}}));return r.a.createElement("div",{className:"lab-selector"},r.a.createElement("div",{className:"lab-selector-text"},"Which Lab?"),r.a.createElement(R,{className:"lab-selector-dropdown",options:u,onChange:s}),r.a.createElement(q.a,{type:"primary",onClick:function(){t.startSession(e.labs.filter((function(e){return e.lid===c}))[0])},disabled:null===c},"Start Session"))};n(252);var V=function(){var e=g();return r.a.createElement("div",{className:"page-session-new"},r.a.createElement(Y,{labs:e.labs}))};function _(e){var t=function(e){return new Date(null,null,null,null,null,null,e)}(e);return t.toTimeString().substr(0,8)}function K(e){return function(e,t){return _(t-e)}(e,Date.now())}function U(e,t){return function(n){return n in e?e[n]:t}}n(253);var $=function(e){return r.a.createElement("div",{className:"statistic"},r.a.createElement("div",{className:"statistic-title"},e.title),r.a.createElement("div",{className:"statistic-value"},e.value))};n(254);var Q=function(){var e=k(),t=Object(a.useState)(K(e.startTime)),n=Object(i.a)(t,2),o=n[0],c=n[1];return Object(a.useEffect)((function(){var t=setInterval((function(){c(K(e.startTime))}),1e3);return function(){return clearInterval(t)}})),r.a.createElement($,{title:"Duration",value:o})},X=n(158),Z=n.n(X),ee={width:1280,height:720,facingMode:"user"};var te=function(e){var t=r.a.useRef(null);return Object(a.useEffect)((function(){var n=setInterval((function(){var n=t.current.getScreenshot();e.onPostImage(n)}),1e3);return function(){return clearInterval(n)}})),Object(a.useMemo)((function(){return r.a.createElement(Z.a,{className:"image-capturer",audio:!1,ref:t,screenshotFormat:"image/jpeg",videoConstraints:ee})}),[])},ne=n(347),ae=n(353),re=U({A:"Present",L:"Late",AB:"Absent w/o valid reason",MC:"Absent w valid reason"},"No status"),oe=U({A:"A",L:"L",AB:"AB",MC:"MC"},"N"),ce=U({A:"green",L:"gold",AB:"red",MC:"blue"},"grey");var se=function(e){var t=e.abbreviate?oe(e.status):re(e.status),n=ce(e.status);return r.a.createElement(ae.a,{color:n},t)},ie={A:0,L:1,AB:2,MC:3};var ue=function(e){var t=y.a.sortBy(e.students,[function(e){return ie[e.status]},"name"]);return r.a.createElement(ne.a,{className:"student-list",dataSource:t,renderItem:function(e){return r.a.createElement(ne.a.Item,{className:"student-list-item",key:e.mid},r.a.createElement(ne.a.Item.Meta,{title:e.name}),r.a.createElement(se,{abbreviate:!0,status:e.status}))}})},le=(n(264),T.a.confirm);var me=function(){var e=k();return Object(a.useMemo)((function(){return r.a.createElement("div",{className:"page-session-ongoing"},r.a.createElement("div",{className:"session-info"},r.a.createElement("div",{className:"session-info-header"},r.a.createElement($,{title:"Lab Group",value:b(e.lab)}),r.a.createElement(q.a,{type:"danger",onClick:function(){le({title:"Do you want to end this session?",okText:"Yes",cancelText:"No",onOk:e.endSession})}},"End Session")),r.a.createElement(ue,{students:e.students})),r.a.createElement("div",{className:"live-capture"},r.a.createElement("div",{className:"live-capture-header"},r.a.createElement("div",{className:"live-capture-title"},"Live Capture"),r.a.createElement(Q,null)),r.a.createElement(te,{onPostImage:e.postImage})))}),[e.lab,e.students,e.postImage,e.endSession])};var fe=Object(C.g)((function(e){var t=k();return Object(a.useMemo)((function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.d,null,r.a.createElement(J,{path:"".concat(e.match.path,"/new"),when:t.isOnGoing,to:"".concat(e.match.path,"/ongoing"),component:V}),r.a.createElement(J,{path:"".concat(e.match.path,"/ongoing"),when:!t.isOnGoing,to:"".concat(e.match.path,"/new"),component:me}),r.a.createElement(J,{exect:!0,path:"".concat(e.match.path,"/"),when:t.isOnGoing,to:"".concat(e.match.path,"/ongoing"),component:V})))}),[t.isOnGoing,e.match.path])}));var de=function(){return r.a.createElement("div",{className:"page-labs"},"labs")},pe=n(160),ge=n.n(pe);n(265);var ve=function(){return r.a.createElement("div",{className:"logo"},r.a.createElement("img",{src:ge.a,alt:"logo"}))},he=n(349),be=n(350),Ee=n(9);n(266);var Oe=he.a.create({name:"normal_login"})((function(e){var t=g(),n=e.form.getFieldDecorator;return r.a.createElement("div",{className:"login-form-container"},r.a.createElement(he.a,{onSubmit:function(n){n.preventDefault(),e.form.validateFields((function(e,n){e||t.signIn(n)}))},className:"login-form"},r.a.createElement(he.a.Item,null,n("username",{rules:[{required:!0,message:"Please input your username!"}]})(r.a.createElement(be.a,{prefix:r.a.createElement(Ee.a,{type:"user",style:{color:"rgba(0,0,0,.25)"}}),placeholder:"Username"}))),r.a.createElement(he.a.Item,null,n("password",{rules:[{required:!0,message:"Please input your Password!"}]})(r.a.createElement(be.a,{prefix:r.a.createElement(Ee.a,{type:"lock",style:{color:"rgba(0,0,0,.25)"}}),type:"password",placeholder:"Password"}))),r.a.createElement(he.a.Item,null,r.a.createElement(q.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in"))))}));n(343);var je=function(){return r.a.createElement("div",{className:"page-signin"},r.a.createElement(ve,null),r.a.createElement(Oe,null))};var ye=Object(C.g)((function(e){var t=g(),n=k(),o=Object(a.useState)(null),c=Object(i.a)(o,2),s=c[0],u=c[1];Object(a.useEffect)((function(){var t,a,r=e.location.pathname;s!==r&&(a=r,"/session/ongoing"===(t=s)&&n.isOnGoing&&(m.a.destroy(),m.a.warning("Recording paused. \n Go back to session page to resume")),a.startsWith("/session")&&null!==t&&!t.startsWith("/session")&&n.isOnGoing&&(m.a.destroy(),m.a.success("Recording resumed.")),u(r))}),[e.location.pathname,s,n.isOnGoing]);var l=function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(C.b,{path:"/session",component:fe}),r.a.createElement(C.b,{path:"/labs",component:de}),r.a.createElement(C.b,{exact:!0,path:"/",component:fe}))};return Object(a.useMemo)((function(){return r.a.createElement("div",{className:"content"},r.a.createElement(J,{exact:!0,path:"/signin",when:t.isSignedIn,to:"/session",component:je}),r.a.createElement(J,{path:"/",when:!t.isSignedIn,to:"/signin",component:l}))}),[t.isSignedIn])})),Se=(n(344),A.a.Header),we=A.a.Content;var Ne=function(){return r.a.createElement(A.a,{className:"ant-layout"},r.a.createElement(Se,{className:"ant-layout-header"},r.a.createElement(W,null)),r.a.createElement(we,{className:"ant-layout-content"},r.a.createElement(ye,null)))};var ke=function(){return r.a.createElement(h,null,r.a.createElement(x,null,r.a.createElement(s.a,null,r.a.createElement("div",{className:"App"},r.a.createElement(Ne,null)))))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(r.a.createElement(ke,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[168,1,2]]]);
//# sourceMappingURL=main.d399bd5e.chunk.js.map